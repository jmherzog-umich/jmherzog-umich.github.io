<!DOCTYPE html>
<html lang="en">

  <!-- Mathjax Support -->
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>librad: C++ Radiative Transfer Library | Joshua M. Herzog</title>
<meta name="generator" content="Jekyll v4.3.2">
<meta property="og:title" content="librad: C++ Radiative Transfer Library">
<meta property="og:locale" content="en_US">
<meta name="description" content="Research Fellow - University of Michigan, Department of Mechanical Engineering">
<meta property="og:description" content="Research Fellow - University of Michigan, Department of Mechanical Engineering">
<link rel="canonical" href="http://localhost:4000/code/librad">
<meta property="og:url" content="http://localhost:4000/code/librad">
<meta property="og:site_name" content="Joshua M. Herzog">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="librad: C++ Radiative Transfer Library">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Research Fellow - University of Michigan, Department of Mechanical Engineering","headline":"librad: C++ Radiative Transfer Library","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/"}},"url":"http://localhost:4000/code/librad"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
<link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Joshua M. Herzog">
<script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]],"displayMath":[["$$","$$"],["\\[","\\]"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<header class="site-header" role="banner">

  <div class="wrapper">
<a class="site-title" rel="author" href="/">Joshua M. Herzog
    </a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger">
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewbox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
            </svg>
          </span>
        </label>

        <div class="trigger">
<a class="page-link" href="/research/">Research</a><a class="page-link" href="/publications/">Publications</a><a class="page-link" href="/presentations/">Presentations</a><a class="page-link" href="/students/">Students</a><div class="dropdown">
                <a class="page-link" href="/code/">Code▼</a>
                <ul class="dropdown-content">
<li class="dropdown-link"><a href="/code/mcrad">MCRAD: Monte Carlo RAdiation Diffusion</a></li>
<li class="dropdown-link"><a href="/code/librad">librad: C++ Radiative Transfer Library</a></li>
<li class="dropdown-link"><a href="/code/raytracer">Non-sequential ray tracer</a></li>
</ul>
              </div>
<a class="page-link" href="/datasets/">Datasets</a><a class="page-link" href="/gallery/">Gallery</a>
</div>
      </nav>
</div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        

<article class="post">

  <header class="post-header">
    <h1 class="post-title">librad: C++ Radiative Transfer Library</h1>
  </header><div class="introtext">
      
    </div>
<div class="post-content">
<div class="introtext">
<p><strong>librad</strong> is a C++ library that calculates a variety of functions used in 
Chandrasekhar’s radiative transfer theory<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> including the \(X\), \(Y\), and \(H\)
functions. These functions can be used to calculate diffuse reflection, transmission
and absorption coefficients for strongly scattering materials, even for strongly
anisotropic cases. The code contains no external dependencies and uses only the 
C++ standard library. The code is available on my Github account
<a href="https://github.com/jmherzog-umich/librad">here</a>.</p>

</div>
<div class="vsep"></div>
<div class="vspace"></div>
<div class="post-subcontent">
        

<p><strong>librad</strong> implements several components including:</p>
<ul>
  <li>a variety of numeric integration/Gaussian quadrature routines
    <ol>
      <li>Tanh-Sinh (or double-exponential) quadrature</li>
      <li>Gaussian-Legendre quadrature using an asymptotic expansion <sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup> <sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>
</li>
      <li>Several other related methods</li>
    </ol>
  </li>
  <li>iterative solutions to \(H\), \(X\), and \(Y\) using Tanh-Sinh quadrature</li>
  <li>approximate analytic solutions to \(H\) <sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup>
</li>
  <li>reflectance, transmittance, and absorbance calculations for a planar layer</li>
</ul>

<p>Some solutions for isotropic scattering are presented in the following figures.</p>

<figure>
  <img src="/figures/librad-H.png" alt="Plots of Chandrasekhar's H-function for isotropic scattering" style="width:100%">
  <figcaption>Several plots of Chandrasekhar's H-function for isotropic scattering calculated with librad as a function of incidence angle with several albedo values (left) and a heatmap illustrating H for a wider range of conditions (right).</figcaption>
</figure>

<figure>
  <img src="/figures/librad-X.png" alt="Plots of Chandrasekhar's X-function for isotropic scattering" style="width:100%">
  <figcaption>Several plots of Chandrasekhar's X-function for isotropic scattering at normal incidence calculated with librad as a function of optical thickness (left) and heatmap illustrating X at a wider range of conditions.</figcaption>
</figure>

<figure>
  <img src="/figures/librad-Y.png" alt="Plots of Chandrasekhar's Y-function for isotropic scattering" style="width:100%">
  <figcaption>Several plots of Chandrasekhar's Y-function for isotropic scattering at normal incidence calculated with librad as a function of optical thickness (left) and heatmap illustrating Y at a wider range of conditions.</figcaption>
</figure>

<p><strong>librad</strong> evaluates the \(X\) and \(Y\) functions iteratively through the following integro-differential equations</p>

\[\begin{aligned}
	\frac{\partial Y}{\partial\tau} + \frac{Y}{\mu} = X \overset{1}{\underset{0}{\int}} \frac{du}{u} \; \Phi(u) Y \\
	\frac{\partial X}{\partial \tau} = Y \overset{1}{\underset{0}{\int}} \frac{du}{u} \; \Phi(u) Y 
\end{aligned}\]

<p>subject to the initial condition</p>

\[X(\tau=0,\mu) = Y(\tau=0,\mu) = 1.\]

<p>for \(\mu &gt; 0\). The \(H\) function for the isotropic scattering case is evaluated using a closed form integral representation<sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">5</a></sup> that requires
only a single numeric integral:</p>

\[\ln H = -\frac{\mu}{\pi} \overset{\frac{\pi}{2}}{\underset{0}{\int}} \frac{\ln (1 - \alpha x \cot x)}{\cos^2 x + \mu^2 \sin^2 x} dx\]

<p>for the isotropic scattering case where \(\alpha\) is the albedo.</p>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p><em>Chandrasekhar, Subrahmanyan. Radiative transfer. Dover publications, 1960.</em> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><em>Bogaert, Ignace. “Iteration-free computation of Gauss–Legendre quadrature nodes and weights.” SIAM Journal on Scientific Computing 36.3 (2014): A1008-A1026.</em> <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><em>Bogaert, Ignace. “Fast Gauss-Legendre Quadrature Rules”, http://sourceforge.net/projects/fastgausslegendrequadrature.</em> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:4" role="doc-endnote">
      <p><em>Davidović, Dragomir M., Jovan Vukanić, and Dušan Arsenović. “Two new analytic approximations of the Chandrasekhar’s H function for isotropic scattering.” Icarus 194.1 (2008): 389-397.</em> <a href="#fnref:4" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:5" role="doc-endnote">
      <p><em>Kawabata, Kiyoshi, and Sanjay S. Limaye. “Rational approximation formula for Chandrasekhar’s H-function for isotropic scattering.” Astrophysics and Space Science 332.2 (2011): 365-371.</em> <a href="#fnref:5" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
  </ol>
</div>

      </div>
</div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <h2 class="footer-heading">Joshua M. Herzog</h2>
        <ul class="contact-list">
<li class="p-name">Research Fellow</li>
<li class="p-name">Mechanical Engineering</li>
<li class="p-name">University of Michigan</li>
<li class="p-name">jmherzog _at_ umich.edu</li>
</ul>
      </div>

      <div class="footer-col footer-col-2">
<ul class="social-media-list">
<li><a href="https://orcid.org/0000-0001-9089-819X"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#orcid"></use></svg> <span class="username">0000-0001-9089-819X</span></a></li>
<li><a href="https://scholar.google.com/citations?user=frqdXXYAAAAJ"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#google_scholar"></use></svg> <span class="username">frqdXXYAAAAJ</span></a></li>
<li><a href="https://github.com/jmherzog-umich"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">jmherzog-umich</span></a></li>
<li><a href="https://www.linkedin.com/in/joshua-herzog-01841374"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">joshua-herzog-01841374</span></a></li>
</ul>
</div>

      <div class="footer-col footer-col-3">
<ul class="links-list"><li>
            <a href="https://www.umich.edu">
                <img src="/assets/logos/UM.svg">
            </a>
        </li></ul>
</div>
    </div>

  </div>

</footer>
</body>

</html>
